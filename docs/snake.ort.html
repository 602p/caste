<html>
	<head>
		<title>../os/kernel/kapps/snake/snake.ort</title>
		<link rel="stylesheet" type="text/css" href="syntax.css">
	</head>
	<body>
		<pre>

<span class="orth-T_IMPORT">import framebuffer</span><br/><span class="orth-T_IMPORT">import &quot;kapps/snake/rng.ort&quot;</span><br/><span class="orth-T_IMPORT">import mm</span><br/><br/><span class="orth-T_TYPEDECL">type</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_TYPEDECL_NAME">Segment</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_TYPEDECL_IS">is</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">int x</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">int y</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">Segment _next</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT">int x</span><span class="orth-T_ARGLIST_SEPERATOR">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ARGLIST_ELEMENT">int y</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">Segment::new</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">Segment</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">Segment new</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">malloc</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_INTRINSIC">@sizeof(Segment)@</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">Segment</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">x</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">x</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">y</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">y</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">_next</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">ptr</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">Segment</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">new</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT">Segment s</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">Segment:has_next</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">bool</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">_next</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">ptr</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">int</span><span class="orth-T_BINARY_OPERATOR">!=</span><span class="orth-T_INTEGER_LITERAL">0</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT">Segment s</span><span class="orth-T_ARGLIST_SEPERATOR">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ARGLIST_ELEMENT">Framebuffer screen</span><span class="orth-T_ARGLIST_SEPERATOR">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ARGLIST_ELEMENT">bool head</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">Segment:draw</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">void</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">screen</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">fillrect</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">x</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_INTEGER_LITERAL">16</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">y</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_INTEGER_LITERAL">16</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">16</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">16</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">255</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">255</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_NAME">head</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">int</span><span class="orth-T_PAREN_CLOSE">)</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">s</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">has_next</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">_next</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">draw</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">screen</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">bool</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT">Segment s</span><span class="orth-T_ARGLIST_SEPERATOR">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ARGLIST_ELEMENT">Framebuffer screen</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">Segment:clear</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">void</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">screen</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">fillrect</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">x</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_INTEGER_LITERAL">16</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">y</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_INTEGER_LITERAL">16</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">16</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">16</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><br/><span class="orth-T_TYPEDECL_END">endtype</span><br/><br/><span class="orth-T_TYPEDECL">type</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_TYPEDECL_NAME">Snake</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_TYPEDECL_IS">is</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">Segment head</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">int direction</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_LINE_COMMENT">#0=up, 1=down, 2=left, 3=right</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">Snake::new</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">Snake</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">Snake new</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">malloc</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_INTRINSIC">@sizeof(Snake)@</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">Snake</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">head</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">Segment</span><span class="orth-T_DOUBLECOLON">::</span><span class="orth-T_NAME">new</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_INTEGER_LITERAL">5</span><span class="orth-T_COMMA">,</span><span class="orth-T_INTEGER_LITERAL">5</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">head</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">_next</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">Segment</span><span class="orth-T_DOUBLECOLON">::</span><span class="orth-T_NAME">new</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_INTEGER_LITERAL">5</span><span class="orth-T_COMMA">,</span><span class="orth-T_INTEGER_LITERAL">4</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">direction</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_INTEGER_LITERAL">3</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">new</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT">Snake s</span><span class="orth-T_ARGLIST_SEPERATOR">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ARGLIST_ELEMENT">Framebuffer screen</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">Snake:draw</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">void</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">head</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">draw</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">screen</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">bool</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT">Snake s</span><span class="orth-T_ARGLIST_SEPERATOR">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ARGLIST_ELEMENT">Framebuffer screen</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">Snake:update</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">bool</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">int new_x</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">head</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">x</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">int new_y</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">head</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">y</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">Segment second_to_last</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">head</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHILE_START">while</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">second_to_last</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">_next</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">_next</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">ptr</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">int</span><span class="orth-T_BINARY_OPERATOR">!=</span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">second_to_last</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">second_to_last</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">_next</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">second_to_last</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">_next</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">clear</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">screen</span><span class="orth-T_PAREN_CLOSE">)</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">second_to_last</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">_next</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">_next</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">head</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">head</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">second_to_last</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">_next</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">second_to_last</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">_next</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">ptr</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">Segment</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">direction</span><span class="orth-T_BINARY_OPERATOR">==</span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">new_y</span><span class="orth-T_AUGASSIGN">-=</span><span class="orth-T_INTEGER_LITERAL">1</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_BLOCK_END_ON_ELIF">eli</span><span class="orth-T_IF_ELIF">f</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">direction</span><span class="orth-T_BINARY_OPERATOR">==</span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">new_y</span><span class="orth-T_AUGASSIGN">+=</span><span class="orth-T_INTEGER_LITERAL">1</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_BLOCK_END_ON_ELIF">eli</span><span class="orth-T_IF_ELIF">f</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">direction</span><span class="orth-T_BINARY_OPERATOR">==</span><span class="orth-T_INTEGER_LITERAL">2</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">new_x</span><span class="orth-T_AUGASSIGN">-=</span><span class="orth-T_INTEGER_LITERAL">1</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_BLOCK_END_ON_ELSE">els</span><span class="orth-T_IF_ELSE">e</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">new_x</span><span class="orth-T_AUGASSIGN">+=</span><span class="orth-T_INTEGER_LITERAL">1</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">head</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">x</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">new_x</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">head</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">y</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">new_y</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">head</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">x</span><span class="orth-T_BINARY_OPERATOR">&lt;</span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">bool</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_BLOCK_END_ON_ELIF">eli</span><span class="orth-T_IF_ELIF">f</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">head</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">y</span><span class="orth-T_BINARY_OPERATOR">&lt;</span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">bool</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">Segment curr</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">head</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHILE_START">while</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">curr</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">_next</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">ptr</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">int</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BINARY_OPERATOR">!=</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">curr</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">curr</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">_next</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">curr</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">x</span><span class="orth-T_BINARY_OPERATOR">==</span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">head</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">x</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">curr</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">y</span><span class="orth-T_BINARY_OPERATOR">==</span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">head</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">y</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">bool</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">s</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">draw</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">screen</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">bool</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT">Snake s</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">Snake:grow</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">void</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">Segment last</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">head</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHILE_START">while</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">last</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">_next</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">ptr</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">int</span><span class="orth-T_BINARY_OPERATOR">!=</span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">last</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">last</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">_next</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">last</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">_next</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">Segment</span><span class="orth-T_DOUBLECOLON">::</span><span class="orth-T_NAME">new</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">last</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">x</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">last</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">y</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT">Snake s</span><span class="orth-T_ARGLIST_SEPERATOR">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ARGLIST_ELEMENT">int x</span><span class="orth-T_ARGLIST_SEPERATOR">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ARGLIST_ELEMENT">int y</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">Snake:contains</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">bool</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">Segment curr</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">head</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHILE_START">while</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">curr</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">_next</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">ptr</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">int</span><span class="orth-T_BINARY_OPERATOR">!=</span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">curr</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">x</span><span class="orth-T_BINARY_OPERATOR">==</span><span class="orth-T_NAME">x</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">curr</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">y</span><span class="orth-T_BINARY_OPERATOR">==</span><span class="orth-T_NAME">y</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">bool</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">curr</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">curr</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">_next</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">bool</span><br/><span class="orth-T_TYPEDECL_END">endtype</span><br/><br/><span class="orth-T_TYPEDECL">type</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_TYPEDECL_NAME">Food</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_TYPEDECL_IS">is</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">int x</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">int y</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">int bound_w</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">int bound_h</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT">int bound_w</span><span class="orth-T_ARGLIST_SEPERATOR">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ARGLIST_ELEMENT">int bound_h</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">Food::new</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">Food</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">Food new</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">malloc</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_INTRINSIC">@sizeof(Food)@</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">Food</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">bound_h</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">bound_h</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">bound_w</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">bound_w</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">x</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_INTEGER_LITERAL">0</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">y</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_INTEGER_LITERAL">0</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">new</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT">Food f</span><span class="orth-T_ARGLIST_SEPERATOR">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ARGLIST_ELEMENT">Snake snake</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">Food:gen_pos</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">void</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">f</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">x</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">s_randint</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_COMMA">,</span><span class="orth-T_NAME">f</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">bound_w</span><span class="orth-T_BINARY_OPERATOR">-</span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">f</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">y</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">s_randint</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_COMMA">,</span><span class="orth-T_NAME">f</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">bound_h</span><span class="orth-T_BINARY_OPERATOR">-</span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_PAREN_CLOSE">)</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHILE_START">while</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">snake</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">contains</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">f</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">x</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">f</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">y</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">f</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">x</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">s_randint</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_COMMA">,</span><span class="orth-T_NAME">f</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">bound_w</span><span class="orth-T_BINARY_OPERATOR">-</span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">f</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">y</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">s_randint</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_COMMA">,</span><span class="orth-T_NAME">f</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">bound_h</span><span class="orth-T_BINARY_OPERATOR">-</span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT">Food f</span><span class="orth-T_ARGLIST_SEPERATOR">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ARGLIST_ELEMENT">Framebuffer screen</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">Food:draw</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">void</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">screen</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">fillrect</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">f</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">x</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_INTEGER_LITERAL">16</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">f</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">y</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_INTEGER_LITERAL">16</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">16</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">16</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">255</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT">Food f</span><span class="orth-T_ARGLIST_SEPERATOR">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ARGLIST_ELEMENT">Framebuffer screen</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">Food:clear</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">void</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">screen</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">fillrect</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">f</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">x</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_INTEGER_LITERAL">16</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">f</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">y</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_INTEGER_LITERAL">16</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">16</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">16</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT">Food f</span><span class="orth-T_ARGLIST_SEPERATOR">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ARGLIST_ELEMENT">Framebuffer screen</span><span class="orth-T_ARGLIST_SEPERATOR">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ARGLIST_ELEMENT">Snake snake</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">Food:create_new</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">void</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">f</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">clear</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">screen</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">f</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">gen_pos</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">snake</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">f</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">draw</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">screen</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT">Food f</span><span class="orth-T_ARGLIST_SEPERATOR">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ARGLIST_ELEMENT">Snake s</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">Food:eaten</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">bool</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">f</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">x</span><span class="orth-T_BINARY_OPERATOR">==</span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">head</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">x</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">f</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">y</span><span class="orth-T_BINARY_OPERATOR">==</span><span class="orth-T_NAME">s</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">head</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">y</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">bool</span><br/><span class="orth-T_TYPEDECL_END">endtype</span><br/><br/><span class="orth-T_VAR_DECL">bool snake_running</span><br/><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT">cstr args</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">snake_run</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">void</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">kterm</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">printl</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_STRING_LITERAL">&quot;Starting RNG...&quot;</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">s_lfsr_seed_time</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_PAREN_CLOSE">)</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">Snake snake</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">Snake</span><span class="orth-T_DOUBLECOLON">::</span><span class="orth-T_NAME">new</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_PAREN_CLOSE">)</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">Framebuffer screen</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">Framebuffer</span><span class="orth-T_DOUBLECOLON">::</span><span class="orth-T_NAME">from_mbinfo</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">mbinfo</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">screen</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">fill</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_COMMA">,</span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_COMMA">,</span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_PAREN_CLOSE">)</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">TerminalUpdateHook old_tuh</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">kterm</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">update_hook</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">system_kbdstate</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">set_handler</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">_snake_handler</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">KeyboardConsumerCallback</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">kterm</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">update_hook</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">_snake_term_null_handler</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">TerminalUpdateHook</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">snake_running</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">bool</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">long targ_ticks</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">int width</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">mbinfo</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">screen_w</span><span class="orth-T_BINARY_OPERATOR">/</span><span class="orth-T_INTEGER_LITERAL">16</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">int height</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">mbinfo</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">screen_h</span><span class="orth-T_BINARY_OPERATOR">/</span><span class="orth-T_INTEGER_LITERAL">16</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">width</span><span class="orth-T_BINARY_OPERATOR">&gt;</span><span class="orth-T_INTEGER_LITERAL">32</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">width</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_INTEGER_LITERAL">32</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">kterm</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">printl</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_STRING_LITERAL">&quot;Width truncated to 32&quot;</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">height</span><span class="orth-T_BINARY_OPERATOR">&gt;</span><span class="orth-T_INTEGER_LITERAL">32</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">height</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_INTEGER_LITERAL">32</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">kterm</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">printl</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_STRING_LITERAL">&quot;Height truncated to 32&quot;</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">Food food</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">Food</span><span class="orth-T_DOUBLECOLON">::</span><span class="orth-T_NAME">new</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">width</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">height</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">food</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">create_new</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">screen</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">snake</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><br/><span class="orth-T_WHITESPACE">	</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">screen</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">fillrect</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">width</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_INTEGER_LITERAL">16</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">mbinfo</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">screen_w</span><span class="orth-T_BINARY_OPERATOR">-</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">width</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_INTEGER_LITERAL">16</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">mbinfo</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">screen_h</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">255</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">255</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">255</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">screen</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">fillrect</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">height</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_INTEGER_LITERAL">16</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">mbinfo</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">screen_w</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">mbinfo</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">screen_h</span><span class="orth-T_BINARY_OPERATOR">-</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">height</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_INTEGER_LITERAL">16</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">255</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">255</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">255</span><span class="orth-T_PAREN_CLOSE">)</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL">int score</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">0</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHILE_START">while</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">snake_running</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">targ_ticks</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">pic_ticks</span><span class="orth-T_BINARY_OPERATOR">+</span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">long</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHILE_START">while</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">targ_ticks</span><span class="orth-T_BINARY_OPERATOR">&gt;</span><span class="orth-T_NAME">pic_ticks</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_INTEGER_LITERAL">0</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">snake</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">update</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">screen</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">snake_running</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">bool</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">snake</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">head</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">x</span><span class="orth-T_BINARY_OPERATOR">&gt;=</span><span class="orth-T_NAME">width</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">snake_running</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">bool</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_BLOCK_END_ON_ELIF">eli</span><span class="orth-T_IF_ELIF">f</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">snake</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">head</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">y</span><span class="orth-T_BINARY_OPERATOR">&gt;=</span><span class="orth-T_NAME">height</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">snake_running</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">bool</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">system_kbdstate</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">getkey</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_INTEGER_LITERAL">72</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_LINE_COMMENT">#UP</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">snake</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">direction</span><span class="orth-T_BINARY_OPERATOR">!=</span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">snake</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">direction</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_INTEGER_LITERAL">0</span><br/><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_BLOCK_END_ON_ELIF">eli</span><span class="orth-T_IF_ELIF">f</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">system_kbdstate</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">getkey</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_INTEGER_LITERAL">80</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_LINE_COMMENT">#DOWN</span><br/><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">snake</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">direction</span><span class="orth-T_BINARY_OPERATOR">!=</span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">snake</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">direction</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_INTEGER_LITERAL">1</span><br/><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_BLOCK_END_ON_ELIF">eli</span><span class="orth-T_IF_ELIF">f</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">system_kbdstate</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">getkey</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_INTEGER_LITERAL">75</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_LINE_COMMENT">#LEFT</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">snake</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">direction</span><span class="orth-T_BINARY_OPERATOR">!=</span><span class="orth-T_INTEGER_LITERAL">3</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">snake</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">direction</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_INTEGER_LITERAL">2</span><br/><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_BLOCK_END_ON_ELIF">eli</span><span class="orth-T_IF_ELIF">f</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">system_kbdstate</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">getkey</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_INTEGER_LITERAL">77</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_LINE_COMMENT">#RIGHT</span><br/><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">snake</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">direction</span><span class="orth-T_BINARY_OPERATOR">!=</span><span class="orth-T_INTEGER_LITERAL">2</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">snake</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">direction</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_INTEGER_LITERAL">3</span><br/><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><br/><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">food</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">eaten</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">snake</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">snake</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">grow</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">food</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">create_new</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">screen</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">snake</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">score</span><span class="orth-T_AUGASSIGN">+=</span><span class="orth-T_INTEGER_LITERAL">1</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">kterm</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME">update_hook</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">old_tuh</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">kterm</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">blank</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">kterm</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">printl</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_STRING_LITERAL">&quot;Game Over!&quot;</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">kterm</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">print</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_STRING_LITERAL">&quot;Your Score is &quot;</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">kterm</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">printi</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">score</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_RETURN">return</span><br/><br/><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT">uint scancode</span><span class="orth-T_ARGLIST_SEPERATOR">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ARGLIST_ELEMENT">bool state</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">_snake_handler</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">void</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">scancode</span><span class="orth-T_BINARY_OPERATOR">==</span><span class="orth-T_INTEGER_LITERAL">16</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME">or</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">scancode</span><span class="orth-T_BINARY_OPERATOR">==</span><span class="orth-T_INTEGER_LITERAL">27</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_LINE_COMMENT">#q, or ESC</span><br/><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">snake_running</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME">bool</span><br/><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><span class="orth-T_RETURN">return</span><br/><br/><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">_snake_term_null_handler</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">void</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_RETURN">return</span><br/><span class="orth-T_WHITESPACE"> </span>

		</pre>
	</body>
</html>